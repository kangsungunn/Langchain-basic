# PR title linting.
#
# FORMAT (Conventional Commits 1.0.0):
#
#   <type>[optional scope]: <description>
#   [optional body]
#   [optional footer(s)]
#
# Examples:
#     feat(core): add multiâ€tenant support
#     fix(cli): resolve flag parsing error
#     docs: update API usage examples
#     docs(openai): update API usage examples
#
# Allowed Types:
#   * feat       â€” a new feature (MINOR)
#   * fix        â€” a bug fix (PATCH)
#   * docs       â€” documentation only changes
#   * style      â€” formatting, linting, etc.; no code change or typing refactors
#   * refactor   â€” code change that neither fixes a bug nor adds a feature
#   * perf       â€” code change that improves performance
#   * test       â€” adding tests or correcting existing
#   * build      â€” changes that affect the build system/external dependencies
#   * ci         â€” continuous integration/configuration changes
#   * chore      â€” other changes that don't modify source or test files
#   * revert     â€” reverts a previous commit
#   * release    â€” prepare a new release
#
# Allowed Scope(s) (optional):
#   core, cli, langchain, langchain_v1, langchain-classic, model-profiles,
#   standard-tests, text-splitters, docs, anthropic, chroma, deepseek, exa,
#   fireworks, groq, huggingface, mistralai, nomic, ollama, openai,
#   perplexity, prompty, qdrant, xai, infra, deps
#
# Multiple scopes can be used by separating them with a comma.
#
# Rules:
#   1. The 'Type' must start with a lowercase letter.
#   2. Breaking changes: append "!" after type/scope (e.g., feat!: drop x support)
#   3. When releasing (updating the pyproject.toml and uv.lock), the commit message
#      should be: `release(scope): x.y.z` (e.g., `release(core): 1.2.0` with no
#      body, footer, or preceeding/proceeding text).
#
# Enforces Conventional Commits format for pull request titles to maintain a clear and
# machine-readable change history.

name: "ğŸ·ï¸ PR Title Lint"

permissions:
  pull-requests: read

on:
  pull_request:
    types: [opened, edited, synchronize]

jobs:
  # Validates that PR title follows Conventional Commits 1.0.0 specification
  lint-pr-title:
    name: "validate format"
    runs-on: ubuntu-latest
    # Dependabot PRì€ ê²€ì¦ ê±´ë„ˆë›°ê¸°
    # ì—¬ëŸ¬ ì¡°ê±´ìœ¼ë¡œ Dependabot PR í™•ì¸:
    # 1. actorê°€ dependabot[bot]ì´ ì•„ë‹ˆê³ 
    # 2. PR ì œëª©ì´ "Bump"ë¡œ ì‹œì‘í•˜ì§€ ì•Šê±°ë‚˜
    # 3. PR ì‘ì„±ìê°€ botì´ ì•„ë‹Œ ê²½ìš°ì—ë§Œ ì‹¤í–‰
    if: |
      github.actor != 'dependabot[bot]' &&
      !startsWith(github.event.pull_request.title, 'Bump') &&
      github.event.pull_request.user.type != 'Bot'
    steps:
      - name: "âœ… Validate Conventional Commits Format"
        uses: amannn/action-semantic-pull-request@v6
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          types: |
            feat
            fix
            docs
            style
            refactor
            perf
            test
            build
            ci
            chore
            revert
            release
          scopes: |
            core
            cli
            langchain
            langchain-classic
            model-profiles
            standard-tests
            text-splitters
            docs
            anthropic
            chroma
            deepseek
            exa
            fireworks
            groq
            huggingface
            mistralai
            nomic
            ollama
            openai
            perplexity
            prompty
            qdrant
            xai
            infra
            deps
          requireScope: false
          disallowScopes: |
            release
            [A-Z]+
          ignoreLabels: |
            ignore-lint-pr-title
